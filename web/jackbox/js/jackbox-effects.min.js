(function(k){function C(){var b=k(this),a=b.data("fx");if(D.hasOwnProperty(a))D[a](b)}function N(b,a){var c=k(this);if("zoom"!==b){var e=parseInt(c.attr("width"),10)||c.width(),f=parseInt(c.attr("height"),10)||c.height(),e=k("<img />").attr({width:e,height:f}).data({fx:b,width:e,height:f,settings:a}).insertAfter(c);if(O)e.one("load.cj",C);e.attr("src",c.attr("data-src"));c.remove()}else if(e=c.attr("data-zoom"))c=k("<img />").data({fx:b,thumb:c,settings:a}).one("load.cj",C),c.attr("src",e)}function v(b, a){var c=k("<canvas />").attr(a).css(P),e,f=a.width,d=a.height;e=c[0].getContext("2d");e.drawImage(b[0],0,0,f,d);return[c,e,e.getImageData(0,0,f,d)]}function x(b){for(var a=b.length,c=4*a,e,f,d;a--;)c-=4,e=c+1,f=e+1,d=0.3*b[c]+0.59*b[e]+0.11*b[f],b[c]=d,b[e]=d,b[f]=d}function z(b,a){for(var c=[],e;a--;)c[a]=b[a];for(b=[];0<c.length;)e=Math.random()*c.length|0,b[b.length]=c[e],c.splice(e,1);return b}function Q(){var b=k(this),a=b.offset(),c=b.data();c.x=a.left;c.y=a.top;Jacked.tween(c.zoom,{opacity:1}); b.on("mousemove.cj",R)}function R(b){var a=k(this).data(),c=b.pageX-a.x,b=b.pageY-a.y,e=a.image.style,f=a.zoom.style,d=a.ww,i=a.hh;0>c||(c>a.width||0>b||b>a.height)||(f.top=((b<i?0:b>a.bufB?a.snapB:b-i)|0)+"px",f.left=((c<d?0:c>a.bufR?a.snapR:c-d)|0)+"px",e.marginTop=(1.5*-b|0)+"px",e.marginLeft=(1.5*-c|0)+"px")}function S(){var b=k(this).off("mousemove.cj");Jacked.tween(b.data("zoom"),{opacity:0})}function T(){var b=k(this).data("fx");Jacked.stopTween(b[0]);b.css("opacity",1);Jacked.tween(b[0],{opacity:0}, {ease:"Sine.easeInOut"})}function E(b){var a=k(this).data(),c=a.fx,e=c.length,f={opacity:0},d={opacity:1},i={visibility:"hidden",opacity:1},h={ease:"Quad.easeIn"};"mouseenter"===b.type?(a.fx=c=z(c,e),f=d={opacity:0}):(f={opacity:1},d={opacity:0});for(;e--;)b=c[e],a=b[1],b=b[0],h.delay=20*e,Jacked.stopTween(b[0]),Jacked.stopTween(a[0]),b.css("opacity",1),a.css(i),Jacked.tween(b[0],f,h),Jacked.tween(a[0],d,h)}function F(){for(var b=k(this).data("fx"),a=b.length,c={};a--;)itm=b[a],data=itm.data(),c.left= data.origLeft,c.top=data.origTop,Jacked.tween(itm[0],c)}function G(){var b=k(this).data(),a=b.fx,c=a.length,e=b.cols,f=b.newW,d=b.newH,i={},h;for(b.fx=a=z(a,c);c--;)b=c%e,h=c/e|0,i.left=f*b,i.top=d*h,Jacked.tween(a[c][0],i)}function H(b){for(var a=k(this).data("fx"),c=a.length,e=c,f,d,i="mouseenter"===b.type,h={ease:"Linear.easeNone"},g={opacity:0},l={opacity:1};c--;)b=a[c],f=b[1],d=b[2],b=b[0],Jacked.stopTween(b[0]),Jacked.stopTween(d[0]),Jacked.stopTween(f[0]),b.css("opacity",1),d.css("opacity", 1),f.css("opacity",0),i?(h.delay=50*c,Jacked.tween(d[0],g,h),Jacked.tween(b[0],g,h)):(h.delay=50*(e-c),Jacked.tween(d[0],g,h),Jacked.tween(f[0],l,h))}function I(b){var a=k(this).data("fx"),c=a.length,e={duration:400,ease:"Sine.easeOut"},f={};"mouseenter"===b.type?(b=U,f.opacity=0):(b=V,f.opacity=1);for(;c--;)itm=a[c],Jacked.special(itm[0],{duration:400,ease:"Sine.easeOut",callback:b}),Jacked.tween(itm[1],f,e)}function U(b,a){b.style[r]="rotate("+-180*(1-a)+"deg)";b.cjFx.style[r]="rotate("+180*a+"deg)"} function V(b,a){b.style[r]="rotate("+-180*a+"deg)";b.cjFx.style[r]="rotate("+180*(1-a)+"deg)"}function J(b){var a=k(this).data("fx"),c,e={},f,d={duration:400,ease:"Sine.easeOut"};if("mouseenter"===b.type){var i=a.length-1;f=W;e.opacity=0;for(b=c=-1;b++<i;)clearTimeout(a[b].cjTimeout),a[b].cjTimeout=setTimeout(function(){c++;itm=a[c];Jacked.special(itm[0],{ease:"Sine.easeOut",callback:f});Jacked.tween(itm[1],e,d)},50*b)}else{f=X;e.opacity=1;for(c=b=a.length;b--;)clearTimeout(a[b].cjTimeout),a[b].cjTimeout= setTimeout(function(){c--;itm=a[c];Jacked.special(itm[0],{ease:"Sine.easeOut",callback:f});Jacked.tween(itm[1],e,d)},50*b)}}function W(b,a){b.style[r]="rotateX("+-180*(1-a)+"deg)";b.cjFx.style[r]="rotateX("+180*a+"deg)"}function X(b,a){b.style[r]="rotateX("+-180*a+"deg)";b.cjFx.style[r]="rotateX("+180*(1-a)+"deg)"}function K(b){var a=k(this).data("fx"),c=j=c,e;if("mouseenter"===b.type){b=a.length-1;e=Y;for(c=j=-1;c++<b;)clearTimeout(a[c].cjTimeout),a[c].cjTimeout=setTimeout(function(){j++;Jacked.special(a[j], {duration:400,ease:"Sine.easeOut",callback:e})},50*c)}else{e=Z;for(j=c=a.length;c--;)clearTimeout(a[c].cjTimeout),a[c].cjTimeout=setTimeout(function(){j--;Jacked.special(a[j],{duration:400,ease:"Sine.easeOut",callback:e})},50*c)}}function Y(b,a){var c=1-a;b.style[r]="scale("+a+","+a+")";b.cjFx.style[r]="scale("+c+","+c+")"}function Z(b,a){var c=1-a;b.style[r]="scale("+c+","+c+")";b.cjFx.style[r]="scale("+a+","+a+")"}var L={shineContrast:1.5,shineBrightness:30,zoomBorder:"1px solid rgba(0, 0, 0, 0.7)", zoomBorderIE:"1px solid #000",rubixBorder:"3px solid rgba(0, 0, 0, 0.75)",rubixBorderIE:"3px solid #000",cols:4,rows:3,color:"#FFF",reversed:!1},D={shine:function(b){for(var a=b.data(),c=v(b,{width:a.width,height:a.height}),e=c[2],f=c[1],c=c[0],d=a.settings,a=d.shineContrast,d=d.shineBrightness,i=e.data,h=i.length,g=4*h,l,k,m,q,p;h--;)g-=4,l=g+1,k=l+1,m=i[g]*a+d,q=i[l]*a+d,p=i[k]*a+d,i[g]=255<m?255:0>m?0:m,i[l]=255<q?255:0>q?0:q,i[k]=255<p?255:0>p?0:p;f.putImageData(e,0,0);f.restore();c.css("opacity", 0).insertAfter(b);b=b.parent();"inline"===b.css("display")&&b.css("display","inline-block");b.css("position","relative").data("fx",c).on("mouseover.cj",T)},blinds:function(b){var a=b.data(),c=a.height,e=a.width,f=v(b,{width:e,height:c}),d=f[2],i=f[1],h=f[0][0],g=a.settings,a=g.cols,l=g.rows,n=g.color,g=a*l,m=Math.ceil(e/a),l=Math.ceil(c/l),q,p,u,c=k("<div />").css({top:0,left:0,width:e,height:c,overflow:"hidden",position:"absolute"}),e={width:m,height:l,display:"block",overflow:"hidden",position:"absolute"}, n={opacity:0,width:m,height:l,display:"block",position:"absolute",backgroundColor:n};x(d.data);for(i.putImageData(d,0,0);g--;)d=g%a,i=g/a|0,d*=m,u=l*i,e.top=u,e.left=d,i=k("<span />").css(e).appendTo(c),p=k("<span />").css(n).appendTo(i),q=k("<canvas />").appendTo(i),f[g]=[i,q,p],q[0].getContext("2d").drawImage(h,d,u,m,l,0,0,m,l);h=b.parent();c.insertAfter(b);"inline"===h.css("display")&&h.css("display","inline-block");h.css("position","relative").data("fx",f).on("mouseenter.cj",H).on("mouseleave.cj", H)},scramble:function(b){var a=b.data(),c=a.height,e=a.width,f=v(b,{width:e,height:c}),d=f[2],i=f[1],h=f[0][0],g,l=a.settings,n=l.reversed,a=l.cols,l=l.rows,m=a*l;g=m;var q=e/a|0,p=c/l|0,u={},s,t=k("<div />").css({top:0,left:0,width:e,height:c,overflow:"hidden",position:"absolute"}),r={width:q,height:p,display:"block",overflow:"hidden",position:"absolute"};for(i.putImageData(d,0,0);m--;)i=m%a,d=m/a|0,i*=q,d*=p,u.origLeft=i,u.origTop=d,s=f[m]=k("<span />").data(u).appendTo(t),s=k("<canvas />").appendTo(s), s[0].getContext("2d").drawImage(h,i,d,q,p,0,0,q,p);n?(f=z(f,g),h=F,n=G):(h=G,n=F);for(;g--;)i=g%a,d=g/a|0,r.left=q*i,r.top=p*d,f[g].css(r);g=b.parent();"inline"===g.css("display")&&g.css("display","inline-block");g.css({position:"relative",height:c,width:e}).data({fx:f,cols:a,rows:l,newW:q,newH:p}).on("mouseenter.cj",h).on("mouseleave.cj",n);t.insertAfter(b);b.remove()},rubix:function(b){var a=b.data(),c=a.height,e=a.width,f=v(b,{width:e,height:c}),d=f[2],i=f[1],h=f[0][0],g=a.settings,a=g.cols,l= g.rows,n=g.color,m=a*l,q=Math.ceil(e/a),l=Math.ceil(c/l),g=!A?g.rubixBorder:g.rubixBorderIE,c=k("<div />").css({top:0,left:0,width:e,height:c,overflow:"hidden",position:"absolute"}),p,r,e={width:q,height:l,display:"block",overflow:"hidden",position:"absolute"},n={opacity:0,width:q,height:l,border:g,display:"block",position:"absolute",backgroundColor:n,boxSizing:"border-box"};x(d.data);for(i.putImageData(d,0,0);m--;)d=m%a,i=m/a|0,d*=q,r=l*i,e.left=d,e.top=r,g=k("<span />").css(e).appendTo(c),i=k("<span />").css(n).appendTo(g), p=k("<canvas />").appendTo(g),f[m]=[g,i],p[0].getContext("2d").drawImage(h,d,r,q,l,0,0,q,l);h=b.parent();c.insertAfter(b);"inline"===h.css("display")&&h.css("display","inline-block");h.css("position","relative").data("fx",f).on("mouseenter.cj",E).on("mouseleave.cj",E)},rotate:function(b){var a=b.data(),c=a.height,e=a.width,f={width:e,height:c},d=v(b,f),i=d[0][0],h=d[2],g=d[1],d=a.settings,a=d.cols,d=d.rows,l=a*d,n=Math.ceil(e/a),m=Math.ceil(c/d),q,p,u,s,c=k("<div />").css({top:0,left:0,width:e,height:c, overflow:"hidden"}),e={position:"absolute",overflow:"hidden",display:"block",height:m,width:n},t={position:"absolute",overflow:"hidden",display:"block",height:m,width:n};c[0].style[y]="preserve-3d";t[r]="rotateZ(-180deg)";g.putImageData(h,0,0);g.restore();d=v(b,f);h=d[2];g=d[1];f=d[0][0];x(h.data);for(g.putImageData(h,0,0);l--;)h=l%a,g=l/a|0,h*=n,s=m*g,e.left=t.left=h,e.top=t.top=s,p=k("<span />").css(t).appendTo(c),g=k("<span />").css(e).appendTo(c),u=k("<canvas />").appendTo(p),q=k("<canvas />").appendTo(g), p[0].cjFx=g[0],d[l]=[p[0],q[0]],u[0].getContext("2d").drawImage(i,h,s,n,m,0,0,n,m),q[0].getContext("2d").drawImage(f,h,s,n,m,0,0,n,m);i=b.parent();"inline"===i.css("display")&&i.css("display","inline-block");i.css("position","relative").data("fx",d).on("mouseenter.cj",I).on("mouseleave.cj",I);c.insertAfter(b);b.remove()},flip:function(b){var a=b.data(),c=a.height,e=a.width,f={width:e,height:c},d=v(b,f),i=d[0][0],h=d[2],g=d[1],d=a.settings,a=d.cols,d=d.rows,l=a*d,n=Math.ceil(e/a),m=Math.ceil(c/d), q,p,u,s,c=k("<div />").css({top:0,left:0,width:e,height:c,overflow:"hidden"}),e={position:"absolute",overflow:"hidden",display:"block",height:m,width:n},t={position:"absolute",overflow:"hidden",display:"block",height:m,width:n},d=c[0].style;d[B]="100px";d[y]="preserve-3d";t[r]="rotateX(-180deg)";g.putImageData(h,0,0);d=v(b,f);h=d[2];g=d[1];f=d[0][0];x(h.data);for(g.putImageData(h,0,0);l--;)h=l%a,g=l/a|0,h*=n,s=m*g,e.left=t.left=h,e.top=t.top=s,p=k("<span />").css(t).appendTo(c),g=k("<span />").css(e).appendTo(c), u=k("<canvas />").appendTo(p),q=k("<canvas />").appendTo(g),p[0].cjFx=g[0],d[l]=[p[0],q[0]],u[0].getContext("2d").drawImage(i,h,s,n,m,0,0,n,m),q[0].getContext("2d").drawImage(f,h,s,n,m,0,0,n,m);i=b.parent();c.insertAfter(b);"inline"===i.css("display")&&i.css("display","inline-block");i.css("position","relative").data("fx",d).on("mouseenter.cj",J).on("mouseleave.cj",J);b.remove()},scale:function(b){var a=b.data(),c=a.height,e=a.width,f={width:e,height:c},d=v(b,f),i=d[0][0],h=d[2],g=d[1],d=a.settings, a=d.cols,d=d.rows,l=a*d,n=Math.ceil(e/a),m=Math.ceil(c/d),q,p,u,s,c=k("<div />").css({top:0,left:0,width:e,height:c,overflow:"hidden"}),e={position:"absolute",overflow:"hidden",display:"block",height:m,width:n},t={position:"absolute",overflow:"hidden",display:"block",height:m,width:n},d=c[0].style;d[B]="75px";d[y]="preserve-3d";t[r]="scale(0, 0)";g.putImageData(h,0,0);d=v(b,f);h=d[2];g=d[1];f=d[0][0];x(h.data);g.putImageData(h,0,0);for(g.restore();l--;)h=l%a,g=l/a|0,h*=n,s=m*g,e.left=t.left=h,e.top= t.top=s,r?(p=k("<span />").css(t).appendTo(c),g=k("<span />").css(e).appendTo(c)):(g=k("<span />").css(e).appendTo(c),p=k("<span />").css(t).appendTo(c)),u=k("<canvas />").appendTo(p),q=k("<canvas />").appendTo(g),p[0].cjFx=g[0],d[l]=p[0],u[0].getContext("2d").drawImage(i,h,s,n,m,0,0,n,m),q[0].getContext("2d").drawImage(f,h,s,n,m,0,0,n,m);i=b.parent();c.insertAfter(b);"inline"===i.css("display")&&i.css("display","inline-block");i.css("position","relative").data("fx",d).on("mouseenter.cj",K).on("mouseleave.cj", K);b.remove()},zoom:function(b){var a=b.data(),c=a.thumb,e=parseInt(c.attr("width"),10)||c.width(),f=parseInt(c.attr("height"),10)||c.height(),d=b.parent(),i=f>>1,h=i>>1,g=e>>1,l=g>>1,a=k("<div />").css({top:0,left:0,opacity:0,width:g,height:i,overflow:"hidden",position:"absolute",border:!A?a.settings.zoomBorder:a.settings.zoomBorderIE}).insertAfter(c).append(b);k("<div />").insertAfter(c).data({ww:l,hh:h,width:e,image:b[0],height:f,zoom:a[0],bufR:e-l-2,bufB:f-h-2,snapR:e-g-2,snapB:f-i-2}).append(c, a).on("mouseenter.cj",Q).on("mouseleave.cj",S);"inline"===d.css("display")&&d.css("display","inline-block")}},M="undefined"!==typeof Jacked,A,r,O="getContext"in document.createElement("canvas"),P={position:"absolute",left:0,top:0},y,B,w;M&&(A=Jacked.getIE(),r=Jacked.getTransform());k.fn.jackboxFX=function(b,a){var c;a?(c={},k.extend(c,L),k.extend(c,a)):c=L;if(M)return w||(w=document.body.style,B="WebkitPerspective"in w?"WebkitPerspective":"MozPerspective"in w?"MozPerspective":"msPerspective"in w? "msPerspective":"perspective"in w?"perspective":null,y="WebkitTransformStyle"in w?"WebkitTransformStyle":"MozTransformStyle"in w?"MozTransformStyle":"msTransformStyle"in w?"msTransformStyle":"transformStyle"in w?"transformStyle":null),this.each(N,[b,c])}})(jQuery);